function soGoogleMapInitialize(){"undefined"!=typeof google.maps.places&&new sowb.LocationFieldMap(window.jQuery).initMaps()}var sowb=window.sowb||{};sowb.LocationFieldMap=function(e){return{DEFAULT_LOCATIONS:["Addo Elephant National Park, R335, Addo","Cape Town, Western Cape, South Africa","San Francisco Bay Area, CA, United States","New York, NY, United States"],showMap:function(o,t,n){var a,s="user_map_style",i={zoom:10,disableDefaultUI:!0,zoomControl:!0,panControl:!0,center:t,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,s]}},r=new google.maps.Map(o,i),l=new google.maps.Marker({position:t,map:r,draggable:!0});google.maps.event.addDomListener(r,"idle",function(){a=r.getCenter()}),google.maps.event.addDomListener(window,"resize",function(){r.setCenter(a)});var c=function(e){this.inputAddress!=e&&(this.inputAddress=e,this.getLocation(this.inputAddress).done(function(e){r.setZoom(15),r.setCenter(e),l.setPosition(e),l.setTitle(this.inputAddress)}.bind(this)))}.bind(this),d=e(n.autocompleteElement),p=n.autocomplete;p.addListener("place_changed",function(){var e=p.getPlace();r.setZoom(15),e.geometry&&(r.setCenter(e.geometry.location),l.setPosition(e.geometry.location))}),google.maps.event.addDomListener(n.autocompleteElement,"keypress",function(e){var o=e.keyCode||e.which;"13"==o&&e.preventDefault()}),d.focusin(function(){if(!this.resultsObserver){var o=document.querySelector(".pac-container");this.resultsObserver=new MutationObserver(function(){var o=e(e(".pac-item").get(0)),t=o.find(".pac-item-query").text(),n=o.find("span").not("[class]").text(),a=t+(n?", "+n:"");a&&c(a)});var t={attributes:!0,childList:!0,characterData:!0};this.resultsObserver.observe(o,t)}}.bind(this));var g=function(e){this.getGeocoder().geocode({location:e},function(o,t){if(t==google.maps.GeocoderStatus.OK&&o.length>0){var n=o[0].formatted_address;d.val(n),l.setPosition(e),l.setTitle(n)}}.bind(this))}.bind(this);r.addListener("click",function(e){g(e.latLng)}),l.addListener("dragend",function(e){g(e.latLng)})},initMaps:function(){var o=e(".so-contactform-location-autocomplete");o.each(function(o,t){var n=new google.maps.places.Autocomplete(t,{types:["address"]}),a=e(t).siblings(".so-contactform-location-google-map");if(a.length>0){var s=a.data("options");s.autocomplete=n,s.autocompleteElement=t,this.getLocation(s.address).done(function(e){this.showMap(a.get(0),e,s)}.bind(this)).fail(function(){a.append("<div><p><strong>There were no results for the place you entered. Please try another.</strong></p></div>")})}}.bind(this))},getGeocoder:function(){return this._geocoder||(this._geocoder=new google.maps.Geocoder),this._geocoder},getLocation:function(o){var t,n=new e.Deferred,a={address:o};if(o&&o.indexOf(",")>-1){var s=o.split(",");s&&2==s.length&&(t=new google.maps.LatLng(s[0],s[1]),isNaN(t.lat())||isNaN(t.lng())||(a={location:{lat:t.lat(),lng:t.lng()}}))}if(a.hasOwnProperty("location"))n.resolve(a.location);else if(a.hasOwnProperty("address")){if(!a.address){var i=parseInt(Math.random()*this.DEFAULT_LOCATIONS.length);a.address=this.DEFAULT_LOCATIONS[i]}this.getGeocoder().geocode(a,function(e,o){o==google.maps.GeocoderStatus.OK?n.resolve(e[0].geometry.location):o==google.maps.GeocoderStatus.ZERO_RESULTS&&n.reject(o)})}return n}}},jQuery(function(e){if(window.google&&window.google.maps&&window.google.maps.places)soGoogleMapInitialize();else{var o=e(".so-contactform-location-google-map"),t=o.length?o.data("options").apiKey:null,n="https://maps.googleapis.com/maps/api/js?callback=soGoogleMapInitialize&libraries=places";t&&(n+="&key="+t);var a=e('<script type="text/javascript" src="'+n+'">');e("body").append(a)}});